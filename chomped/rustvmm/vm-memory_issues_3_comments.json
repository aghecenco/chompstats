[{"user": {"following_url": "https://api.github.com/users/dagrh/following{/other_user}", "url": "https://api.github.com/users/dagrh", "site_admin": false, "gists_url": "https://api.github.com/users/dagrh/gists{/gist_id}", "node_id": "MDQ6VXNlcjYzMjk3NjA=", "starred_url": "https://api.github.com/users/dagrh/starred{/owner}{/repo}", "gravatar_id": "", "id": 6329760, "events_url": "https://api.github.com/users/dagrh/events{/privacy}", "avatar_url": "https://avatars1.githubusercontent.com/u/6329760?v=4", "login": "dagrh", "repos_url": "https://api.github.com/users/dagrh/repos", "subscriptions_url": "https://api.github.com/users/dagrh/subscriptions", "followers_url": "https://api.github.com/users/dagrh/followers", "html_url": "https://github.com/dagrh", "received_events_url": "https://api.github.com/users/dagrh/received_events", "type": "User", "organizations_url": "https://api.github.com/users/dagrh/orgs"}, "issue_url": "https://api.github.com/repos/rust-vmm/vm-memory/issues/3", "body": "I've got the following which I think is OK, might need some more checks:\r\n`Subject: [PATCH] GuestMemoryMap: from_regions\r\n\r\nAdd a method to take a vector of MmapRegion's that already exist and\r\nturn them into a GuestMemoryMap.\r\n\r\nSigned-off-by: Dr. David Alan Gilbert <dgilbert@redhat.com>\r\n---\r\n src/mmap.rs | 22 ++++++++++++++++++++++\r\n 1 file changed, 22 insertions(+)\r\n\r\ndiff --git a/src/mmap.rs b/src/mmap.rs\r\nindex 236867b..1cefd81 100644\r\n--- a/src/mmap.rs\r\n+++ b/src/mmap.rs\r\n@@ -349,6 +349,28 @@ impl GuestMemoryMmap {\r\n             regions: Arc::new(regions),\r\n         })\r\n     }\r\n+\r\n+    pub fn from_regions(ranges: Vec<GuestRegionMmap>) -> std::result::Result<Self, MmapError> {\r\n+        if ranges.is_empty() {\r\n+            return Err(MmapError::NoMemoryRegion);\r\n+        }\r\n+\r\n+        for rangei in 1..ranges.len() {\r\n+            let range = &ranges[rangei];\r\n+            let last = &ranges[rangei - 1];\r\n+            if last\r\n+                .guest_base\r\n+                .checked_add(last.mapping.len() as GuestAddressValue)\r\n+                .map_or(true, |a| a > range.min_addr())\r\n+            {\r\n+                return Err(MmapError::MemoryRegionOverlap);\r\n+            }\r\n+        }\r\n+\r\n+        Ok(Self {\r\n+            regions: Arc::new(ranges),\r\n+        })\r\n+    }\r\n }\r\n \r\n impl GuestMemory for GuestMemoryMmap {\r\n-- \r\n2.20.1\r\n\r\n`\r\n", "updated_at": "2019-03-22T17:30:25Z", "url": "https://api.github.com/repos/rust-vmm/vm-memory/issues/comments/475709234", "author_association": "CONTRIBUTOR", "html_url": "https://github.com/rust-vmm/vm-memory/issues/3#issuecomment-475709234", "created_at": "2019-03-22T17:27:46Z", "id": 475709234, "node_id": "MDEyOklzc3VlQ29tbWVudDQ3NTcwOTIzNA=="}, {"user": {"following_url": "https://api.github.com/users/dagrh/following{/other_user}", "url": "https://api.github.com/users/dagrh", "site_admin": false, "gists_url": "https://api.github.com/users/dagrh/gists{/gist_id}", "node_id": "MDQ6VXNlcjYzMjk3NjA=", "starred_url": "https://api.github.com/users/dagrh/starred{/owner}{/repo}", "gravatar_id": "", "id": 6329760, "events_url": "https://api.github.com/users/dagrh/events{/privacy}", "avatar_url": "https://avatars1.githubusercontent.com/u/6329760?v=4", "login": "dagrh", "repos_url": "https://api.github.com/users/dagrh/repos", "subscriptions_url": "https://api.github.com/users/dagrh/subscriptions", "followers_url": "https://api.github.com/users/dagrh/followers", "html_url": "https://github.com/dagrh", "received_events_url": "https://api.github.com/users/dagrh/received_events", "type": "User", "organizations_url": "https://api.github.com/users/dagrh/orgs"}, "issue_url": "https://api.github.com/repos/rust-vmm/vm-memory/issues/3", "body": "\r\n[0001-GuestMemoryMap-from_regions.patch.txt](https://github.com/rust-vmm/vm-memory/files/2997732/0001-GuestMemoryMap-from_regions.patch.txt)\r\n", "updated_at": "2019-03-22T18:02:09Z", "url": "https://api.github.com/repos/rust-vmm/vm-memory/issues/comments/475721894", "author_association": "CONTRIBUTOR", "html_url": "https://github.com/rust-vmm/vm-memory/issues/3#issuecomment-475721894", "created_at": "2019-03-22T18:02:09Z", "id": 475721894, "node_id": "MDEyOklzc3VlQ29tbWVudDQ3NTcyMTg5NA=="}, {"user": {"following_url": "https://api.github.com/users/jiangliu/following{/other_user}", "url": "https://api.github.com/users/jiangliu", "site_admin": false, "gists_url": "https://api.github.com/users/jiangliu/gists{/gist_id}", "node_id": "MDQ6VXNlcjE5MzE1MTY=", "starred_url": "https://api.github.com/users/jiangliu/starred{/owner}{/repo}", "gravatar_id": "", "id": 1931516, "events_url": "https://api.github.com/users/jiangliu/events{/privacy}", "avatar_url": "https://avatars0.githubusercontent.com/u/1931516?v=4", "login": "jiangliu", "repos_url": "https://api.github.com/users/jiangliu/repos", "subscriptions_url": "https://api.github.com/users/jiangliu/subscriptions", "followers_url": "https://api.github.com/users/jiangliu/followers", "html_url": "https://github.com/jiangliu", "received_events_url": "https://api.github.com/users/jiangliu/received_events", "type": "User", "organizations_url": "https://api.github.com/users/jiangliu/orgs"}, "issue_url": "https://api.github.com/repos/rust-vmm/vm-memory/issues/3", "body": "Fixed by https://github.com/rust-vmm/vm-memory/pull/5", "updated_at": "2019-04-01T03:49:16Z", "url": "https://api.github.com/repos/rust-vmm/vm-memory/issues/comments/478425864", "author_association": "MEMBER", "html_url": "https://github.com/rust-vmm/vm-memory/issues/3#issuecomment-478425864", "created_at": "2019-04-01T03:49:16Z", "id": 478425864, "node_id": "MDEyOklzc3VlQ29tbWVudDQ3ODQyNTg2NA=="}]