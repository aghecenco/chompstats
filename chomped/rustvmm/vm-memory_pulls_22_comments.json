[{"user": {"following_url": "https://api.github.com/users/petrutlucian94/following{/other_user}", "url": "https://api.github.com/users/petrutlucian94", "site_admin": false, "gists_url": "https://api.github.com/users/petrutlucian94/gists{/gist_id}", "node_id": "MDQ6VXNlcjQ1NzA3NDk=", "starred_url": "https://api.github.com/users/petrutlucian94/starred{/owner}{/repo}", "gravatar_id": "", "id": 4570749, "events_url": "https://api.github.com/users/petrutlucian94/events{/privacy}", "avatar_url": "https://avatars1.githubusercontent.com/u/4570749?v=4", "login": "petrutlucian94", "repos_url": "https://api.github.com/users/petrutlucian94/repos", "subscriptions_url": "https://api.github.com/users/petrutlucian94/subscriptions", "followers_url": "https://api.github.com/users/petrutlucian94/followers", "html_url": "https://github.com/petrutlucian94", "received_events_url": "https://api.github.com/users/petrutlucian94/received_events", "type": "User", "organizations_url": "https://api.github.com/users/petrutlucian94/orgs"}, "issue_url": "https://api.github.com/repos/rust-vmm/vm-memory/issues/22", "body": "A few matters that we may want to figure out before merging this:\r\n\r\n* Do we need separate buildkite jobs for arm or x86 for the vm-memory crate?\r\n* Should we have additional agent tags so that we can just pick the os type (e.g. windows, linux, etc) and ignore the host cpu arch (arm or x86) or host type (bare metal or vm)?\r\n* Do we need musl jobs?\r\n* Do we actually need a separate pipeline that covers the \"backend-mmap\" feature? This is the only available implementation at the moment.\r\n", "updated_at": "2019-05-28T09:26:42Z", "url": "https://api.github.com/repos/rust-vmm/vm-memory/issues/comments/496438420", "author_association": "CONTRIBUTOR", "html_url": "https://github.com/rust-vmm/vm-memory/pull/22#issuecomment-496438420", "created_at": "2019-05-28T09:26:42Z", "id": 496438420, "node_id": "MDEyOklzc3VlQ29tbWVudDQ5NjQzODQyMA=="}, {"user": {"following_url": "https://api.github.com/users/andreeaflorescu/following{/other_user}", "url": "https://api.github.com/users/andreeaflorescu", "site_admin": false, "gists_url": "https://api.github.com/users/andreeaflorescu/gists{/gist_id}", "node_id": "MDQ6VXNlcjI4MTU5NDQ=", "starred_url": "https://api.github.com/users/andreeaflorescu/starred{/owner}{/repo}", "gravatar_id": "", "id": 2815944, "events_url": "https://api.github.com/users/andreeaflorescu/events{/privacy}", "avatar_url": "https://avatars0.githubusercontent.com/u/2815944?v=4", "login": "andreeaflorescu", "repos_url": "https://api.github.com/users/andreeaflorescu/repos", "subscriptions_url": "https://api.github.com/users/andreeaflorescu/subscriptions", "followers_url": "https://api.github.com/users/andreeaflorescu/followers", "html_url": "https://github.com/andreeaflorescu", "received_events_url": "https://api.github.com/users/andreeaflorescu/received_events", "type": "User", "organizations_url": "https://api.github.com/users/andreeaflorescu/orgs"}, "issue_url": "https://api.github.com/repos/rust-vmm/vm-memory/issues/22", "body": "> A few matters that we may want to figure out before merging this:\r\n> \r\n>     * Do we need separate buildkite jobs for arm or x86 for the vm-memory crate?\r\n\r\nWhat do you mean by jobs? I would like to have the vm-memory tested on both platforms for each PR if that was the question.\r\n\r\n>     * Should we have additional agent tags so that we can just pick the os type (e.g. windows, linux, etc) and ignore the host cpu arch (arm or x86) or host type (bare metal or vm)?\r\n\r\nThe way I see it is we would add two more tags in Buildkite for the OS as well (one windows, one linux). This means that we would end up with 4 tags: windows, linux, arm.metal, x86.metal. Each agent will have 2 tags: one for the OS and one for the arch. We don't currently take into account the host type, but in the future we might as from what I understand Intel plans to test it with nested as well. @sameo can probably give more details there. As for the arch I think we need two different tags as well because we want to be able to run each pipeline on the corresponding agent configuration (OS and arch). \r\n\r\n>     * Do we need musl jobs?\r\n\r\nWhat do you mean by jobs? We need to test the musl build as well as Firecracker uses musl and we would like to eventually switch to vm-memory as well. Do you mean if we should have a separate pipeline for musl?\r\n\r\n>     * Do we actually need a separate pipeline that covers the \"backend-mmap\" feature? This is the only available implementation at the moment.\r\n\r\nHmm, I am not sure what the best approach here is. I think we should test the vm-memory with and without the backend-mmap feature because projects that use this crate can implement their own backend that fits their needs so we should test that the default configuration (with no features) works as well. It will probably become a nightmare to maintain pipelines for each feature, I think we should think this true and come with some proposals around how this is going to work out.\r\n\r\n", "updated_at": "2019-05-28T09:37:38Z", "url": "https://api.github.com/repos/rust-vmm/vm-memory/issues/comments/496442448", "author_association": "MEMBER", "html_url": "https://github.com/rust-vmm/vm-memory/pull/22#issuecomment-496442448", "created_at": "2019-05-28T09:37:38Z", "id": 496442448, "node_id": "MDEyOklzc3VlQ29tbWVudDQ5NjQ0MjQ0OA=="}, {"user": {"following_url": "https://api.github.com/users/petrutlucian94/following{/other_user}", "url": "https://api.github.com/users/petrutlucian94", "site_admin": false, "gists_url": "https://api.github.com/users/petrutlucian94/gists{/gist_id}", "node_id": "MDQ6VXNlcjQ1NzA3NDk=", "starred_url": "https://api.github.com/users/petrutlucian94/starred{/owner}{/repo}", "gravatar_id": "", "id": 4570749, "events_url": "https://api.github.com/users/petrutlucian94/events{/privacy}", "avatar_url": "https://avatars1.githubusercontent.com/u/4570749?v=4", "login": "petrutlucian94", "repos_url": "https://api.github.com/users/petrutlucian94/repos", "subscriptions_url": "https://api.github.com/users/petrutlucian94/subscriptions", "followers_url": "https://api.github.com/users/petrutlucian94/followers", "html_url": "https://github.com/petrutlucian94", "received_events_url": "https://api.github.com/users/petrutlucian94/received_events", "type": "User", "organizations_url": "https://api.github.com/users/petrutlucian94/orgs"}, "issue_url": "https://api.github.com/repos/rust-vmm/vm-memory/issues/22", "body": "Thanks for feedback. By jobs I meant buildkite steps. which may or may not be part of the same pipeline. I'll update the PR shortly.", "updated_at": "2019-05-28T09:43:12Z", "url": "https://api.github.com/repos/rust-vmm/vm-memory/issues/comments/496444437", "author_association": "CONTRIBUTOR", "html_url": "https://github.com/rust-vmm/vm-memory/pull/22#issuecomment-496444437", "created_at": "2019-05-28T09:43:12Z", "id": 496444437, "node_id": "MDEyOklzc3VlQ29tbWVudDQ5NjQ0NDQzNw=="}, {"user": {"following_url": "https://api.github.com/users/petrutlucian94/following{/other_user}", "url": "https://api.github.com/users/petrutlucian94", "site_admin": false, "gists_url": "https://api.github.com/users/petrutlucian94/gists{/gist_id}", "node_id": "MDQ6VXNlcjQ1NzA3NDk=", "starred_url": "https://api.github.com/users/petrutlucian94/starred{/owner}{/repo}", "gravatar_id": "", "id": 4570749, "events_url": "https://api.github.com/users/petrutlucian94/events{/privacy}", "avatar_url": "https://avatars1.githubusercontent.com/u/4570749?v=4", "login": "petrutlucian94", "repos_url": "https://api.github.com/users/petrutlucian94/repos", "subscriptions_url": "https://api.github.com/users/petrutlucian94/subscriptions", "followers_url": "https://api.github.com/users/petrutlucian94/followers", "html_url": "https://github.com/petrutlucian94", "received_events_url": "https://api.github.com/users/petrutlucian94/received_events", "type": "User", "organizations_url": "https://api.github.com/users/petrutlucian94/orgs"}, "issue_url": "https://api.github.com/repos/rust-vmm/vm-memory/issues/22", "body": "The last commit doesn't look too good. We've ended up with lots of pipelines and duplicated stuff that is difficult to maintain. I haven't even defined all 8 possible pipelines, it's just so that we can discuss the options we have.\r\n\r\nA couple of ideas to make it better:\r\n* try to use dynamic pipelines https://github.com/buildkite/dynamic-pipeline-example\r\n    * our pipeline \"generator\" script should be as clean as possible, otherwise this will lead to even more headaches\r\n    * we'd probably end up with a single pipeline with multiple generated steps\r\n* use subdirs, so that pipeline.linux.mmap.x86.gnu becomes\r\n    .buildkite/pipelines/linux/mmap/x86/gnu\r\n* simplify step names (e.g. unittests-gnu-arm becomes unnittests) since the additional details should be part of the pipeline name\r\n\r\nTo get Windows tested quicker, I guess the best way to move forward is to just have two pipelines: one for Linux (similar to the kvm ioctls one https://buildkite.com/rust-vmm/kvm-ioctls-ci/settings) and one for Windows. The linux one can continue to define multiple steps, depending on the platform and standard library.\r\n\r\n", "updated_at": "2019-05-28T12:22:51Z", "url": "https://api.github.com/repos/rust-vmm/vm-memory/issues/comments/496475702", "author_association": "CONTRIBUTOR", "html_url": "https://github.com/rust-vmm/vm-memory/pull/22#issuecomment-496475702", "created_at": "2019-05-28T11:24:18Z", "id": 496475702, "node_id": "MDEyOklzc3VlQ29tbWVudDQ5NjQ3NTcwMg=="}, {"user": {"following_url": "https://api.github.com/users/andreeaflorescu/following{/other_user}", "url": "https://api.github.com/users/andreeaflorescu", "site_admin": false, "gists_url": "https://api.github.com/users/andreeaflorescu/gists{/gist_id}", "node_id": "MDQ6VXNlcjI4MTU5NDQ=", "starred_url": "https://api.github.com/users/andreeaflorescu/starred{/owner}{/repo}", "gravatar_id": "", "id": 2815944, "events_url": "https://api.github.com/users/andreeaflorescu/events{/privacy}", "avatar_url": "https://avatars0.githubusercontent.com/u/2815944?v=4", "login": "andreeaflorescu", "repos_url": "https://api.github.com/users/andreeaflorescu/repos", "subscriptions_url": "https://api.github.com/users/andreeaflorescu/subscriptions", "followers_url": "https://api.github.com/users/andreeaflorescu/followers", "html_url": "https://github.com/andreeaflorescu", "received_events_url": "https://api.github.com/users/andreeaflorescu/received_events", "type": "User", "organizations_url": "https://api.github.com/users/andreeaflorescu/orgs"}, "issue_url": "https://api.github.com/repos/rust-vmm/vm-memory/issues/22", "body": "@petrutlucian94 forgot to ask: what Rust version are you using in the windows container? In the linux one we currently have rust 1.33.0. I think it makes sense to use the same rust version when testing the code.", "updated_at": "2019-05-30T10:57:21Z", "url": "https://api.github.com/repos/rust-vmm/vm-memory/issues/comments/497291307", "author_association": "MEMBER", "html_url": "https://github.com/rust-vmm/vm-memory/pull/22#issuecomment-497291307", "created_at": "2019-05-30T10:57:21Z", "id": 497291307, "node_id": "MDEyOklzc3VlQ29tbWVudDQ5NzI5MTMwNw=="}, {"user": {"following_url": "https://api.github.com/users/petrutlucian94/following{/other_user}", "url": "https://api.github.com/users/petrutlucian94", "site_admin": false, "gists_url": "https://api.github.com/users/petrutlucian94/gists{/gist_id}", "node_id": "MDQ6VXNlcjQ1NzA3NDk=", "starred_url": "https://api.github.com/users/petrutlucian94/starred{/owner}{/repo}", "gravatar_id": "", "id": 4570749, "events_url": "https://api.github.com/users/petrutlucian94/events{/privacy}", "avatar_url": "https://avatars1.githubusercontent.com/u/4570749?v=4", "login": "petrutlucian94", "repos_url": "https://api.github.com/users/petrutlucian94/repos", "subscriptions_url": "https://api.github.com/users/petrutlucian94/subscriptions", "followers_url": "https://api.github.com/users/petrutlucian94/followers", "html_url": "https://github.com/petrutlucian94", "received_events_url": "https://api.github.com/users/petrutlucian94/received_events", "type": "User", "organizations_url": "https://api.github.com/users/petrutlucian94/orgs"}, "issue_url": "https://api.github.com/repos/rust-vmm/vm-memory/issues/22", "body": "I'm using 1.34.1, I just let rustup-init get the latest stable version. Indeed, it would make sense to use the same version.\r\n\r\nWe should probably pin the version and maybe define a constant within the rust-vmm-ci repo, which could be updated every now and then.", "updated_at": "2019-05-30T11:23:35Z", "url": "https://api.github.com/repos/rust-vmm/vm-memory/issues/comments/497297618", "author_association": "CONTRIBUTOR", "html_url": "https://github.com/rust-vmm/vm-memory/pull/22#issuecomment-497297618", "created_at": "2019-05-30T11:23:35Z", "id": 497297618, "node_id": "MDEyOklzc3VlQ29tbWVudDQ5NzI5NzYxOA=="}, {"user": {"following_url": "https://api.github.com/users/andreeaflorescu/following{/other_user}", "url": "https://api.github.com/users/andreeaflorescu", "site_admin": false, "gists_url": "https://api.github.com/users/andreeaflorescu/gists{/gist_id}", "node_id": "MDQ6VXNlcjI4MTU5NDQ=", "starred_url": "https://api.github.com/users/andreeaflorescu/starred{/owner}{/repo}", "gravatar_id": "", "id": 2815944, "events_url": "https://api.github.com/users/andreeaflorescu/events{/privacy}", "avatar_url": "https://avatars0.githubusercontent.com/u/2815944?v=4", "login": "andreeaflorescu", "repos_url": "https://api.github.com/users/andreeaflorescu/repos", "subscriptions_url": "https://api.github.com/users/andreeaflorescu/subscriptions", "followers_url": "https://api.github.com/users/andreeaflorescu/followers", "html_url": "https://github.com/andreeaflorescu", "received_events_url": "https://api.github.com/users/andreeaflorescu/received_events", "type": "User", "organizations_url": "https://api.github.com/users/andreeaflorescu/orgs"}, "issue_url": "https://api.github.com/repos/rust-vmm/vm-memory/issues/22", "body": "@petrutlucian94 we merged the initial version of the rust-vmm-container. I was also using the latest Rust stable version, but that's not an ideal situation for reproducible builds. I added an issue about this here: https://github.com/rust-vmm/rust-vmm-container/issues/5\r\n\r\nI think it makes a lot of sense to have all the containers used for running the CI in the same repository and when we are upgrading to a newer version we just have to update all Dockerfiles in the same repository. Can you submit a PR with the windows container you are using as well?\r\n\r\nBTW, the container builds are currently hosted in my personal docker hub account, but once I fix some of the pressing issues with the current Dockerfiles, I was thinking about moving them to the rust-vmm organization on DockerHub that was created by @sameo. The pressing issues I am talking about are: https://github.com/rust-vmm/rust-vmm-container/issues/6 and https://github.com/rust-vmm/rust-vmm-container/issues/5", "updated_at": "2019-05-30T11:39:58Z", "url": "https://api.github.com/repos/rust-vmm/vm-memory/issues/comments/497301247", "author_association": "MEMBER", "html_url": "https://github.com/rust-vmm/vm-memory/pull/22#issuecomment-497301247", "created_at": "2019-05-30T11:39:21Z", "id": 497301247, "node_id": "MDEyOklzc3VlQ29tbWVudDQ5NzMwMTI0Nw=="}, {"user": {"following_url": "https://api.github.com/users/petrutlucian94/following{/other_user}", "url": "https://api.github.com/users/petrutlucian94", "site_admin": false, "gists_url": "https://api.github.com/users/petrutlucian94/gists{/gist_id}", "node_id": "MDQ6VXNlcjQ1NzA3NDk=", "starred_url": "https://api.github.com/users/petrutlucian94/starred{/owner}{/repo}", "gravatar_id": "", "id": 4570749, "events_url": "https://api.github.com/users/petrutlucian94/events{/privacy}", "avatar_url": "https://avatars1.githubusercontent.com/u/4570749?v=4", "login": "petrutlucian94", "repos_url": "https://api.github.com/users/petrutlucian94/repos", "subscriptions_url": "https://api.github.com/users/petrutlucian94/subscriptions", "followers_url": "https://api.github.com/users/petrutlucian94/followers", "html_url": "https://github.com/petrutlucian94", "received_events_url": "https://api.github.com/users/petrutlucian94/received_events", "type": "User", "organizations_url": "https://api.github.com/users/petrutlucian94/orgs"}, "issue_url": "https://api.github.com/repos/rust-vmm/vm-memory/issues/22", "body": "Sounds good. I can send a PR against https://github.com/rust-vmm/rust-vmm-container/", "updated_at": "2019-05-30T11:44:40Z", "url": "https://api.github.com/repos/rust-vmm/vm-memory/issues/comments/497302400", "author_association": "CONTRIBUTOR", "html_url": "https://github.com/rust-vmm/vm-memory/pull/22#issuecomment-497302400", "created_at": "2019-05-30T11:44:40Z", "id": 497302400, "node_id": "MDEyOklzc3VlQ29tbWVudDQ5NzMwMjQwMA=="}, {"user": {"following_url": "https://api.github.com/users/andreeaflorescu/following{/other_user}", "url": "https://api.github.com/users/andreeaflorescu", "site_admin": false, "gists_url": "https://api.github.com/users/andreeaflorescu/gists{/gist_id}", "node_id": "MDQ6VXNlcjI4MTU5NDQ=", "starred_url": "https://api.github.com/users/andreeaflorescu/starred{/owner}{/repo}", "gravatar_id": "", "id": 2815944, "events_url": "https://api.github.com/users/andreeaflorescu/events{/privacy}", "avatar_url": "https://avatars0.githubusercontent.com/u/2815944?v=4", "login": "andreeaflorescu", "repos_url": "https://api.github.com/users/andreeaflorescu/repos", "subscriptions_url": "https://api.github.com/users/andreeaflorescu/subscriptions", "followers_url": "https://api.github.com/users/andreeaflorescu/followers", "html_url": "https://github.com/andreeaflorescu", "received_events_url": "https://api.github.com/users/andreeaflorescu/received_events", "type": "User", "organizations_url": "https://api.github.com/users/andreeaflorescu/orgs"}, "issue_url": "https://api.github.com/repos/rust-vmm/vm-memory/issues/22", "body": "@petrutlucian94 works like a charm! <3\r\nI can try to fix the musl unit tests, I think I know what's the problem with the failed test.\r\nCan you also add another commit to delete the travis.yaml since we are switching to buildkite?", "updated_at": "2019-05-30T12:23:48Z", "url": "https://api.github.com/repos/rust-vmm/vm-memory/issues/comments/497311398", "author_association": "MEMBER", "html_url": "https://github.com/rust-vmm/vm-memory/pull/22#issuecomment-497311398", "created_at": "2019-05-30T12:23:34Z", "id": 497311398, "node_id": "MDEyOklzc3VlQ29tbWVudDQ5NzMxMTM5OA=="}, {"user": {"following_url": "https://api.github.com/users/petrutlucian94/following{/other_user}", "url": "https://api.github.com/users/petrutlucian94", "site_admin": false, "gists_url": "https://api.github.com/users/petrutlucian94/gists{/gist_id}", "node_id": "MDQ6VXNlcjQ1NzA3NDk=", "starred_url": "https://api.github.com/users/petrutlucian94/starred{/owner}{/repo}", "gravatar_id": "", "id": 4570749, "events_url": "https://api.github.com/users/petrutlucian94/events{/privacy}", "avatar_url": "https://avatars1.githubusercontent.com/u/4570749?v=4", "login": "petrutlucian94", "repos_url": "https://api.github.com/users/petrutlucian94/repos", "subscriptions_url": "https://api.github.com/users/petrutlucian94/subscriptions", "followers_url": "https://api.github.com/users/petrutlucian94/followers", "html_url": "https://github.com/petrutlucian94", "received_events_url": "https://api.github.com/users/petrutlucian94/received_events", "type": "User", "organizations_url": "https://api.github.com/users/petrutlucian94/orgs"}, "issue_url": "https://api.github.com/repos/rust-vmm/vm-memory/issues/22", "body": "Once we merge this, we may want to trigger the tests again for the other PRs.", "updated_at": "2019-05-30T12:42:42Z", "url": "https://api.github.com/repos/rust-vmm/vm-memory/issues/comments/497316096", "author_association": "CONTRIBUTOR", "html_url": "https://github.com/rust-vmm/vm-memory/pull/22#issuecomment-497316096", "created_at": "2019-05-30T12:42:42Z", "id": 497316096, "node_id": "MDEyOklzc3VlQ29tbWVudDQ5NzMxNjA5Ng=="}, {"user": {"following_url": "https://api.github.com/users/andreeaflorescu/following{/other_user}", "url": "https://api.github.com/users/andreeaflorescu", "site_admin": false, "gists_url": "https://api.github.com/users/andreeaflorescu/gists{/gist_id}", "node_id": "MDQ6VXNlcjI4MTU5NDQ=", "starred_url": "https://api.github.com/users/andreeaflorescu/starred{/owner}{/repo}", "gravatar_id": "", "id": 2815944, "events_url": "https://api.github.com/users/andreeaflorescu/events{/privacy}", "avatar_url": "https://avatars0.githubusercontent.com/u/2815944?v=4", "login": "andreeaflorescu", "repos_url": "https://api.github.com/users/andreeaflorescu/repos", "subscriptions_url": "https://api.github.com/users/andreeaflorescu/subscriptions", "followers_url": "https://api.github.com/users/andreeaflorescu/followers", "html_url": "https://github.com/andreeaflorescu", "received_events_url": "https://api.github.com/users/andreeaflorescu/received_events", "type": "User", "organizations_url": "https://api.github.com/users/andreeaflorescu/orgs"}, "issue_url": "https://api.github.com/repos/rust-vmm/vm-memory/issues/22", "body": "@petrutlucian94 yap! The branches are going to be out of sync anyway so they'll have to rebase on top of these commits.", "updated_at": "2019-05-30T12:50:51Z", "url": "https://api.github.com/repos/rust-vmm/vm-memory/issues/comments/497318081", "author_association": "MEMBER", "html_url": "https://github.com/rust-vmm/vm-memory/pull/22#issuecomment-497318081", "created_at": "2019-05-30T12:50:51Z", "id": 497318081, "node_id": "MDEyOklzc3VlQ29tbWVudDQ5NzMxODA4MQ=="}]