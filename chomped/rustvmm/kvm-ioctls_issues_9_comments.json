[{"user": {"following_url": "https://api.github.com/users/andreeaflorescu/following{/other_user}", "url": "https://api.github.com/users/andreeaflorescu", "site_admin": false, "gists_url": "https://api.github.com/users/andreeaflorescu/gists{/gist_id}", "node_id": "MDQ6VXNlcjI4MTU5NDQ=", "starred_url": "https://api.github.com/users/andreeaflorescu/starred{/owner}{/repo}", "gravatar_id": "", "id": 2815944, "events_url": "https://api.github.com/users/andreeaflorescu/events{/privacy}", "avatar_url": "https://avatars0.githubusercontent.com/u/2815944?v=4", "login": "andreeaflorescu", "repos_url": "https://api.github.com/users/andreeaflorescu/repos", "subscriptions_url": "https://api.github.com/users/andreeaflorescu/subscriptions", "followers_url": "https://api.github.com/users/andreeaflorescu/followers", "html_url": "https://github.com/andreeaflorescu", "received_events_url": "https://api.github.com/users/andreeaflorescu/received_events", "type": "User", "organizations_url": "https://api.github.com/users/andreeaflorescu/orgs"}, "issue_url": "https://api.github.com/repos/rust-vmm/kvm-ioctls/issues/9", "body": "I tried kcov on arm and it hangs. The cargo kcov command doesn't work at all.\r\nRelated issues:\r\n- kcov issue: https://github.com/SimonKagstrom/kcov/issues/267\r\n- cargo kcov issue: https://github.com/kennytm/cargo-kcov/issues/40", "updated_at": "2019-04-08T12:26:52Z", "url": "https://api.github.com/repos/rust-vmm/kvm-ioctls/issues/comments/480810373", "author_association": "MEMBER", "html_url": "https://github.com/rust-vmm/kvm-ioctls/issues/9#issuecomment-480810373", "created_at": "2019-04-08T12:26:52Z", "id": 480810373, "node_id": "MDEyOklzc3VlQ29tbWVudDQ4MDgxMDM3Mw=="}, {"user": {"following_url": "https://api.github.com/users/MrXinWang/following{/other_user}", "url": "https://api.github.com/users/MrXinWang", "site_admin": false, "gists_url": "https://api.github.com/users/MrXinWang/gists{/gist_id}", "node_id": "MDQ6VXNlcjM4NTgyMTYw", "starred_url": "https://api.github.com/users/MrXinWang/starred{/owner}{/repo}", "gravatar_id": "", "id": 38582160, "events_url": "https://api.github.com/users/MrXinWang/events{/privacy}", "avatar_url": "https://avatars1.githubusercontent.com/u/38582160?v=4", "login": "MrXinWang", "repos_url": "https://api.github.com/users/MrXinWang/repos", "subscriptions_url": "https://api.github.com/users/MrXinWang/subscriptions", "followers_url": "https://api.github.com/users/MrXinWang/followers", "html_url": "https://github.com/MrXinWang", "received_events_url": "https://api.github.com/users/MrXinWang/received_events", "type": "User", "organizations_url": "https://api.github.com/users/MrXinWang/orgs"}, "issue_url": "https://api.github.com/repos/rust-vmm/kvm-ioctls/issues/9", "body": "Hi @andreeaflorescu ! we are currently trying to contribute for Arm64 platform, and I think I will try to address this issue. Therefore I am wondering if I can try the integration test locally or must do it on buildkite?\r\n\r\nAlso I think the [README](https://github.com/rust-vmm/rust-vmm-ci/blob/master/README.md) in [rust-vmm/rust-vmm-ci](https://github.com/rust-vmm/rust-vmm-ci) needs to be updated since the folder `tests` is not used anymore (I will do that together with this issue).\r\n\r\nThe idea is: Referencing #8 , I think we have already had a [PR#62](https://github.com/rust-vmm/kvm-ioctls/pull/62) to solve the `run_code` example for Arm64 and we also have unit tests for Arm64 now, so I think this is the only issue left for arm64 support?", "updated_at": "2019-11-25T07:38:23Z", "url": "https://api.github.com/repos/rust-vmm/kvm-ioctls/issues/comments/558030158", "author_association": "NONE", "html_url": "https://github.com/rust-vmm/kvm-ioctls/issues/9#issuecomment-558030158", "created_at": "2019-11-25T07:38:23Z", "id": 558030158, "node_id": "MDEyOklzc3VlQ29tbWVudDU1ODAzMDE1OA=="}, {"user": {"following_url": "https://api.github.com/users/andreeaflorescu/following{/other_user}", "url": "https://api.github.com/users/andreeaflorescu", "site_admin": false, "gists_url": "https://api.github.com/users/andreeaflorescu/gists{/gist_id}", "node_id": "MDQ6VXNlcjI4MTU5NDQ=", "starred_url": "https://api.github.com/users/andreeaflorescu/starred{/owner}{/repo}", "gravatar_id": "", "id": 2815944, "events_url": "https://api.github.com/users/andreeaflorescu/events{/privacy}", "avatar_url": "https://avatars0.githubusercontent.com/u/2815944?v=4", "login": "andreeaflorescu", "repos_url": "https://api.github.com/users/andreeaflorescu/repos", "subscriptions_url": "https://api.github.com/users/andreeaflorescu/subscriptions", "followers_url": "https://api.github.com/users/andreeaflorescu/followers", "html_url": "https://github.com/andreeaflorescu", "received_events_url": "https://api.github.com/users/andreeaflorescu/received_events", "type": "User", "organizations_url": "https://api.github.com/users/andreeaflorescu/orgs"}, "issue_url": "https://api.github.com/repos/rust-vmm/kvm-ioctls/issues/9", "body": "> Hi @andreeaflorescu ! we are currently trying to contribute for Arm64 platform, and I think I will try to address this issue. Therefore I am wondering if I can try the integration test locally or must do it on buildkite?\r\n\r\nYou can try the test locally. You can run the command specified in [Adaptive Coverage](https://github.com/rust-vmm/rust-vmm-ci/blob/master/README.md#adaptive-coverage). For that to work you need to update the path of the coverage test. The new path, relative to the kvm-ioctls directory is `rust-vmm-ci/integration_tests/test_coverage.py`.\r\n\r\n> \r\n> Also I think the [README](https://github.com/rust-vmm/rust-vmm-ci/blob/master/README.md) in [rust-vmm/rust-vmm-ci](https://github.com/rust-vmm/rust-vmm-ci) needs to be updated since the folder `tests` is not used anymore (I will do that together with this issue).\r\n\r\nYap, that's correct.\r\n\r\n> The idea is: Referencing #8 , I think we have already had a [PR#62](https://github.com/rust-vmm/kvm-ioctls/pull/62) to solve the `run_code` example for Arm64 and we also have unit tests for Arm64 now, so I think this is the only issue left for arm64 support?\r\n\r\nOnce the arm code example is merged, that should be the case. I think we also need to add some more tests to arm though. If we can get the coverage, we can see what paths are not covered.\r\n\r\nDid you manage to run kcov on arm? Did they recently added support for this? I am asking because when I tried it, kcov would exit with an error.", "updated_at": "2019-11-25T07:50:02Z", "url": "https://api.github.com/repos/rust-vmm/kvm-ioctls/issues/comments/558033800", "author_association": "MEMBER", "html_url": "https://github.com/rust-vmm/kvm-ioctls/issues/9#issuecomment-558033800", "created_at": "2019-11-25T07:50:02Z", "id": 558033800, "node_id": "MDEyOklzc3VlQ29tbWVudDU1ODAzMzgwMA=="}, {"user": {"following_url": "https://api.github.com/users/MrXinWang/following{/other_user}", "url": "https://api.github.com/users/MrXinWang", "site_admin": false, "gists_url": "https://api.github.com/users/MrXinWang/gists{/gist_id}", "node_id": "MDQ6VXNlcjM4NTgyMTYw", "starred_url": "https://api.github.com/users/MrXinWang/starred{/owner}{/repo}", "gravatar_id": "", "id": 38582160, "events_url": "https://api.github.com/users/MrXinWang/events{/privacy}", "avatar_url": "https://avatars1.githubusercontent.com/u/38582160?v=4", "login": "MrXinWang", "repos_url": "https://api.github.com/users/MrXinWang/repos", "subscriptions_url": "https://api.github.com/users/MrXinWang/subscriptions", "followers_url": "https://api.github.com/users/MrXinWang/followers", "html_url": "https://github.com/MrXinWang", "received_events_url": "https://api.github.com/users/MrXinWang/received_events", "type": "User", "organizations_url": "https://api.github.com/users/MrXinWang/orgs"}, "issue_url": "https://api.github.com/repos/rust-vmm/kvm-ioctls/issues/9", "body": "> The new path, relative to the kvm-ioctls directory is rust-vmm-ci/integration_tests/test_coverage.py.\r\n\r\nabsolutely, my bad, tried this on x86_64 instead, it works perfectly.\r\n\r\n> Did you manage to run kcov on arm? Did they recently added support for this? I am asking because when I tried it, kcov would exit with an error.\r\n\r\nThanks so much for your patience and fast reply! I think that kcov problem explains the reason why I can only run the integration test on my x86 machine (the test hangs on arm64)......I will try to further investigate this problem then. Thanks", "updated_at": "2019-11-25T08:09:36Z", "url": "https://api.github.com/repos/rust-vmm/kvm-ioctls/issues/comments/558037358", "author_association": "NONE", "html_url": "https://github.com/rust-vmm/kvm-ioctls/issues/9#issuecomment-558037358", "created_at": "2019-11-25T08:01:44Z", "id": 558037358, "node_id": "MDEyOklzc3VlQ29tbWVudDU1ODAzNzM1OA=="}, {"user": {"following_url": "https://api.github.com/users/MrXinWang/following{/other_user}", "url": "https://api.github.com/users/MrXinWang", "site_admin": false, "gists_url": "https://api.github.com/users/MrXinWang/gists{/gist_id}", "node_id": "MDQ6VXNlcjM4NTgyMTYw", "starred_url": "https://api.github.com/users/MrXinWang/starred{/owner}{/repo}", "gravatar_id": "", "id": 38582160, "events_url": "https://api.github.com/users/MrXinWang/events{/privacy}", "avatar_url": "https://avatars1.githubusercontent.com/u/38582160?v=4", "login": "MrXinWang", "repos_url": "https://api.github.com/users/MrXinWang/repos", "subscriptions_url": "https://api.github.com/users/MrXinWang/subscriptions", "followers_url": "https://api.github.com/users/MrXinWang/followers", "html_url": "https://github.com/MrXinWang", "received_events_url": "https://api.github.com/users/MrXinWang/received_events", "type": "User", "organizations_url": "https://api.github.com/users/MrXinWang/orgs"}, "issue_url": "https://api.github.com/repos/rust-vmm/kvm-ioctls/issues/9", "body": "Also I remember in my last [PR](https://github.com/rust-vmm/rust-vmm-container/pull/20), problem with kcov was addressed by using python3 instead of python. I will try that too.", "updated_at": "2019-11-25T08:21:27Z", "url": "https://api.github.com/repos/rust-vmm/kvm-ioctls/issues/comments/558043500", "author_association": "NONE", "html_url": "https://github.com/rust-vmm/kvm-ioctls/issues/9#issuecomment-558043500", "created_at": "2019-11-25T08:21:27Z", "id": 558043500, "node_id": "MDEyOklzc3VlQ29tbWVudDU1ODA0MzUwMA=="}, {"user": {"following_url": "https://api.github.com/users/MrXinWang/following{/other_user}", "url": "https://api.github.com/users/MrXinWang", "site_admin": false, "gists_url": "https://api.github.com/users/MrXinWang/gists{/gist_id}", "node_id": "MDQ6VXNlcjM4NTgyMTYw", "starred_url": "https://api.github.com/users/MrXinWang/starred{/owner}{/repo}", "gravatar_id": "", "id": 38582160, "events_url": "https://api.github.com/users/MrXinWang/events{/privacy}", "avatar_url": "https://avatars1.githubusercontent.com/u/38582160?v=4", "login": "MrXinWang", "repos_url": "https://api.github.com/users/MrXinWang/repos", "subscriptions_url": "https://api.github.com/users/MrXinWang/subscriptions", "followers_url": "https://api.github.com/users/MrXinWang/followers", "html_url": "https://github.com/MrXinWang", "received_events_url": "https://api.github.com/users/MrXinWang/received_events", "type": "User", "organizations_url": "https://api.github.com/users/MrXinWang/orgs"}, "issue_url": "https://api.github.com/repos/rust-vmm/kvm-ioctls/issues/9", "body": "Hi @andreeaflorescu !\r\n\r\nMe and my colleague @michael2012z found a method to fix the kcov hang issue on arm64, and I think we still need some time before contributing our patch to the kcov master branch due to some legal limitations.\r\n\r\nHowever I do tested the code coverage of the `/kvm-ioctls` repo, here are the results:\r\n```\r\nrust-vmm-ci/integration_tests/test_coverage.py F                                                                                                   [100%]\r\n\r\n======================================================================== FAILURES ========================================================================\r\n_____________________________________________________________________ test_coverage ______________________________________________________________________\r\n\r\nprofile = 'devel'\r\n\r\n    def test_coverage(profile):\r\n        coverage_config = _read_test_config()\r\n        current_coverage = _get_current_coverage(coverage_config)\r\n        previous_coverage = coverage_config[\"coverage_score\"]\r\n        if previous_coverage < current_coverage:\r\n            if profile == pytest.profile_ci:\r\n                # In the CI Profile we expect the coverage to be manually updated.\r\n                assert False, \"Coverage is increased from {} to {}. \" \\\r\n                              \"Please update the coverage in \" \\\r\n                              \"tests/coverage.\".format(\r\n                    previous_coverage,\r\n                    current_coverage\r\n                )\r\n            elif profile == pytest.profile_devel:\r\n                coverage_config[\"coverage_score\"] = current_coverage\r\n                _write_coverage_config(coverage_config)\r\n            else:\r\n                # This should never happen because pytest should only accept\r\n                # the valid test profiles specified with `choices` in\r\n                # `pytest_addoption`.\r\n                assert False, \"Invalid test profile.\"\r\n        elif previous_coverage > current_coverage:\r\n            diff = float(previous_coverage - current_coverage)\r\n>           assert False, \"Coverage drops by {:.2f}%. Please add unit tests for\" \\\r\n                          \"the uncovered lines.\".format(diff)\r\nE           AssertionError: Coverage drops by 18.20%. Please add unit tests forthe uncovered lines.\r\nE           assert False\r\n\r\nrust-vmm-ci/integration_tests/test_coverage.py:118: AssertionError\r\n```\r\n\r\nWe will keep working on this.", "updated_at": "2019-12-03T02:05:56Z", "url": "https://api.github.com/repos/rust-vmm/kvm-ioctls/issues/comments/560964937", "author_association": "NONE", "html_url": "https://github.com/rust-vmm/kvm-ioctls/issues/9#issuecomment-560964937", "created_at": "2019-12-03T02:05:31Z", "id": 560964937, "node_id": "MDEyOklzc3VlQ29tbWVudDU2MDk2NDkzNw=="}, {"user": {"following_url": "https://api.github.com/users/andreeaflorescu/following{/other_user}", "url": "https://api.github.com/users/andreeaflorescu", "site_admin": false, "gists_url": "https://api.github.com/users/andreeaflorescu/gists{/gist_id}", "node_id": "MDQ6VXNlcjI4MTU5NDQ=", "starred_url": "https://api.github.com/users/andreeaflorescu/starred{/owner}{/repo}", "gravatar_id": "", "id": 2815944, "events_url": "https://api.github.com/users/andreeaflorescu/events{/privacy}", "avatar_url": "https://avatars0.githubusercontent.com/u/2815944?v=4", "login": "andreeaflorescu", "repos_url": "https://api.github.com/users/andreeaflorescu/repos", "subscriptions_url": "https://api.github.com/users/andreeaflorescu/subscriptions", "followers_url": "https://api.github.com/users/andreeaflorescu/followers", "html_url": "https://github.com/andreeaflorescu", "received_events_url": "https://api.github.com/users/andreeaflorescu/received_events", "type": "User", "organizations_url": "https://api.github.com/users/andreeaflorescu/orgs"}, "issue_url": "https://api.github.com/repos/rust-vmm/kvm-ioctls/issues/9", "body": "@MrXinWang wow! That's super nice!\r\n\r\nIf we manage to run kcov on arm as well, we probably need to think about a way to have different coverage files for arm and x86_64. This means we need to update the rust-vmm-ci.\r\n\r\nBtw, can you share the coverage report? I am curious why does the coverage drop by 18.2%.", "updated_at": "2019-12-03T03:15:33Z", "url": "https://api.github.com/repos/rust-vmm/kvm-ioctls/issues/comments/560979630", "author_association": "MEMBER", "html_url": "https://github.com/rust-vmm/kvm-ioctls/issues/9#issuecomment-560979630", "created_at": "2019-12-03T03:15:33Z", "id": 560979630, "node_id": "MDEyOklzc3VlQ29tbWVudDU2MDk3OTYzMA=="}, {"user": {"following_url": "https://api.github.com/users/MrXinWang/following{/other_user}", "url": "https://api.github.com/users/MrXinWang", "site_admin": false, "gists_url": "https://api.github.com/users/MrXinWang/gists{/gist_id}", "node_id": "MDQ6VXNlcjM4NTgyMTYw", "starred_url": "https://api.github.com/users/MrXinWang/starred{/owner}{/repo}", "gravatar_id": "", "id": 38582160, "events_url": "https://api.github.com/users/MrXinWang/events{/privacy}", "avatar_url": "https://avatars1.githubusercontent.com/u/38582160?v=4", "login": "MrXinWang", "repos_url": "https://api.github.com/users/MrXinWang/repos", "subscriptions_url": "https://api.github.com/users/MrXinWang/subscriptions", "followers_url": "https://api.github.com/users/MrXinWang/followers", "html_url": "https://github.com/MrXinWang", "received_events_url": "https://api.github.com/users/MrXinWang/received_events", "type": "User", "organizations_url": "https://api.github.com/users/MrXinWang/orgs"}, "issue_url": "https://api.github.com/repos/rust-vmm/kvm-ioctls/issues/9", "body": "Hi @andreeaflorescu !\r\n\r\n> If we manage to run kcov on arm as well, we probably need to think about a way to have different coverage files for arm and x86_64. This means we need to update the rust-vmm-ci.\r\n\r\nYes of course and I have prepared a patch to update the `test_coverage.py` and new `coverage_config.json` for arm64. However I am wondering if I need to do this for all repos under rust-vmm, and I think I do?\r\n\r\n> Btw, can you share the coverage report? I am curious why does the coverage drop by 18.2%.\r\n\r\nOf course but how? You ok with the screenshots (probably too long)?", "updated_at": "2019-12-03T03:19:13Z", "url": "https://api.github.com/repos/rust-vmm/kvm-ioctls/issues/comments/560980285", "author_association": "NONE", "html_url": "https://github.com/rust-vmm/kvm-ioctls/issues/9#issuecomment-560980285", "created_at": "2019-12-03T03:19:13Z", "id": 560980285, "node_id": "MDEyOklzc3VlQ29tbWVudDU2MDk4MDI4NQ=="}, {"user": {"following_url": "https://api.github.com/users/andreeaflorescu/following{/other_user}", "url": "https://api.github.com/users/andreeaflorescu", "site_admin": false, "gists_url": "https://api.github.com/users/andreeaflorescu/gists{/gist_id}", "node_id": "MDQ6VXNlcjI4MTU5NDQ=", "starred_url": "https://api.github.com/users/andreeaflorescu/starred{/owner}{/repo}", "gravatar_id": "", "id": 2815944, "events_url": "https://api.github.com/users/andreeaflorescu/events{/privacy}", "avatar_url": "https://avatars0.githubusercontent.com/u/2815944?v=4", "login": "andreeaflorescu", "repos_url": "https://api.github.com/users/andreeaflorescu/repos", "subscriptions_url": "https://api.github.com/users/andreeaflorescu/subscriptions", "followers_url": "https://api.github.com/users/andreeaflorescu/followers", "html_url": "https://github.com/andreeaflorescu", "received_events_url": "https://api.github.com/users/andreeaflorescu/received_events", "type": "User", "organizations_url": "https://api.github.com/users/andreeaflorescu/orgs"}, "issue_url": "https://api.github.com/repos/rust-vmm/kvm-ioctls/issues/9", "body": "> Hi @andreeaflorescu !\r\n> \r\n> > If we manage to run kcov on arm as well, we probably need to think about a way to have different coverage files for arm and x86_64. This means we need to update the rust-vmm-ci.\r\n> \r\n> Yes of course and I have prepared a patch to update the `test_coverage.py` and new `coverage_config.json` for arm64. However I am wondering if I need to do this for all repos under rust-vmm, and I think I do?\r\n\r\nWell, I don't think we need to do that for all repositories. We can be inventive here and let `coverage.json` point to the x86_64 coverage and just add an optional coverage_aarch64.json file. We can discuss about this at length in rust-vmm-ci. Do you want to create an issue there or should I? We can discuss about how to move forward on that issue. \r\n\r\n\r\n> > Btw, can you share the coverage report? I am curious why does the coverage drop by 18.2%.\r\n> \r\n> Of course but how? You ok with the screenshots (probably too long)?\r\n\r\nCan you maybe upload the `cov` directory somewhere and paste a link here? You might be able to attach it to this issue if you create an archive out of that coverage directory.\r\n\r\n", "updated_at": "2019-12-03T03:23:54Z", "url": "https://api.github.com/repos/rust-vmm/kvm-ioctls/issues/comments/560981279", "author_association": "MEMBER", "html_url": "https://github.com/rust-vmm/kvm-ioctls/issues/9#issuecomment-560981279", "created_at": "2019-12-03T03:23:54Z", "id": 560981279, "node_id": "MDEyOklzc3VlQ29tbWVudDU2MDk4MTI3OQ=="}, {"user": {"following_url": "https://api.github.com/users/MrXinWang/following{/other_user}", "url": "https://api.github.com/users/MrXinWang", "site_admin": false, "gists_url": "https://api.github.com/users/MrXinWang/gists{/gist_id}", "node_id": "MDQ6VXNlcjM4NTgyMTYw", "starred_url": "https://api.github.com/users/MrXinWang/starred{/owner}{/repo}", "gravatar_id": "", "id": 38582160, "events_url": "https://api.github.com/users/MrXinWang/events{/privacy}", "avatar_url": "https://avatars1.githubusercontent.com/u/38582160?v=4", "login": "MrXinWang", "repos_url": "https://api.github.com/users/MrXinWang/repos", "subscriptions_url": "https://api.github.com/users/MrXinWang/subscriptions", "followers_url": "https://api.github.com/users/MrXinWang/followers", "html_url": "https://github.com/MrXinWang", "received_events_url": "https://api.github.com/users/MrXinWang/received_events", "type": "User", "organizations_url": "https://api.github.com/users/MrXinWang/orgs"}, "issue_url": "https://api.github.com/repos/rust-vmm/kvm-ioctls/issues/9", "body": "@andreeaflorescu  please refer to [rust-vmm-ci/issue#10](https://github.com/rust-vmm/rust-vmm-ci/issues/10)", "updated_at": "2019-12-03T03:29:25Z", "url": "https://api.github.com/repos/rust-vmm/kvm-ioctls/issues/comments/560982372", "author_association": "NONE", "html_url": "https://github.com/rust-vmm/kvm-ioctls/issues/9#issuecomment-560982372", "created_at": "2019-12-03T03:29:25Z", "id": 560982372, "node_id": "MDEyOklzc3VlQ29tbWVudDU2MDk4MjM3Mg=="}]