[{"user": {"following_url": "https://api.github.com/users/acatangiu/following{/other_user}", "url": "https://api.github.com/users/acatangiu", "site_admin": false, "gists_url": "https://api.github.com/users/acatangiu/gists{/gist_id}", "node_id": "MDQ6VXNlcjMxOTE3OTcz", "starred_url": "https://api.github.com/users/acatangiu/starred{/owner}{/repo}", "gravatar_id": "", "id": 31917973, "events_url": "https://api.github.com/users/acatangiu/events{/privacy}", "avatar_url": "https://avatars3.githubusercontent.com/u/31917973?v=4", "login": "acatangiu", "repos_url": "https://api.github.com/users/acatangiu/repos", "subscriptions_url": "https://api.github.com/users/acatangiu/subscriptions", "followers_url": "https://api.github.com/users/acatangiu/followers", "html_url": "https://github.com/acatangiu", "received_events_url": "https://api.github.com/users/acatangiu/received_events", "type": "User", "organizations_url": "https://api.github.com/users/acatangiu/orgs"}, "issue_url": "https://api.github.com/repos/rust-vmm/kvm-ioctls/issues/69", "body": "This test intermittently fails on slow machines, when run under `kcov` (which slows things down even more).\r\n\r\n```rust\r\n    #[test]\r\n    fn test_clock() {\r\n        let kvm = Kvm::new().unwrap();\r\n        let vm = kvm.create_vm().unwrap();\r\n\r\n        // Get current time.\r\n        let orig = vm.get_clock().unwrap();\r\n\r\n        // Reset time.\r\n        let mut fudged = kvm_clock_data::default();\r\n        fudged.clock = 10;\r\n        vm.set_clock(&fudged).unwrap();\r\n\r\n        // Get new time.\r\n        let new = vm.get_clock().unwrap();\r\n\r\n        // Verify new time has progressed but is smaller than orig time.\r\n        assert!(fudged.clock < new.clock);\r\n        assert!(new.clock < orig.clock);\r\n    }\r\n```\r\nI propose the following two options as a fix:\r\n\r\n1. Introduce a `sleep` before `let orig = vm.get_clock().unwrap();` so that `orig` clock gets some extra cycles of advancement. This is kind of an ugly hack as it artificially increases test duration.\r\n2. Just remove `orig`-related lines, only leave `fudged` and `new`. This should still provide good functionality testing and would remove dependency on the hardware speed of the machine the test is running on.", "updated_at": "2019-10-29T10:55:19Z", "url": "https://api.github.com/repos/rust-vmm/kvm-ioctls/issues/comments/547364696", "author_association": "MEMBER", "html_url": "https://github.com/rust-vmm/kvm-ioctls/issues/69#issuecomment-547364696", "created_at": "2019-10-29T10:55:19Z", "id": 547364696, "node_id": "MDEyOklzc3VlQ29tbWVudDU0NzM2NDY5Ng=="}, {"user": {"following_url": "https://api.github.com/users/andreeaflorescu/following{/other_user}", "url": "https://api.github.com/users/andreeaflorescu", "site_admin": false, "gists_url": "https://api.github.com/users/andreeaflorescu/gists{/gist_id}", "node_id": "MDQ6VXNlcjI4MTU5NDQ=", "starred_url": "https://api.github.com/users/andreeaflorescu/starred{/owner}{/repo}", "gravatar_id": "", "id": 2815944, "events_url": "https://api.github.com/users/andreeaflorescu/events{/privacy}", "avatar_url": "https://avatars0.githubusercontent.com/u/2815944?v=4", "login": "andreeaflorescu", "repos_url": "https://api.github.com/users/andreeaflorescu/repos", "subscriptions_url": "https://api.github.com/users/andreeaflorescu/subscriptions", "followers_url": "https://api.github.com/users/andreeaflorescu/followers", "html_url": "https://github.com/andreeaflorescu", "received_events_url": "https://api.github.com/users/andreeaflorescu/received_events", "type": "User", "organizations_url": "https://api.github.com/users/andreeaflorescu/orgs"}, "issue_url": "https://api.github.com/repos/rust-vmm/kvm-ioctls/issues/69", "body": "These tests have exclusive access m5d.metal. What do you mean by slow?", "updated_at": "2019-10-29T17:04:00Z", "url": "https://api.github.com/repos/rust-vmm/kvm-ioctls/issues/comments/547528128", "author_association": "MEMBER", "html_url": "https://github.com/rust-vmm/kvm-ioctls/issues/69#issuecomment-547528128", "created_at": "2019-10-29T17:04:00Z", "id": 547528128, "node_id": "MDEyOklzc3VlQ29tbWVudDU0NzUyODEyOA=="}, {"user": {"following_url": "https://api.github.com/users/acatangiu/following{/other_user}", "url": "https://api.github.com/users/acatangiu", "site_admin": false, "gists_url": "https://api.github.com/users/acatangiu/gists{/gist_id}", "node_id": "MDQ6VXNlcjMxOTE3OTcz", "starred_url": "https://api.github.com/users/acatangiu/starred{/owner}{/repo}", "gravatar_id": "", "id": 31917973, "events_url": "https://api.github.com/users/acatangiu/events{/privacy}", "avatar_url": "https://avatars3.githubusercontent.com/u/31917973?v=4", "login": "acatangiu", "repos_url": "https://api.github.com/users/acatangiu/repos", "subscriptions_url": "https://api.github.com/users/acatangiu/subscriptions", "followers_url": "https://api.github.com/users/acatangiu/followers", "html_url": "https://github.com/acatangiu", "received_events_url": "https://api.github.com/users/acatangiu/received_events", "type": "User", "organizations_url": "https://api.github.com/users/acatangiu/orgs"}, "issue_url": "https://api.github.com/repos/rust-vmm/kvm-ioctls/issues/69", "body": "I meant when it's run on a slow machine **or** under `kcov` which slows things down significantly.", "updated_at": "2019-10-29T17:08:24Z", "url": "https://api.github.com/repos/rust-vmm/kvm-ioctls/issues/comments/547530364", "author_association": "MEMBER", "html_url": "https://github.com/rust-vmm/kvm-ioctls/issues/69#issuecomment-547530364", "created_at": "2019-10-29T17:08:24Z", "id": 547530364, "node_id": "MDEyOklzc3VlQ29tbWVudDU0NzUzMDM2NA=="}]